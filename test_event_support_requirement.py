#!/usr/bin/env python3
"""
Test Event Support Requirement Rule
"""

def test_event_support_requirement():
    """Test Event Support Requirement logic"""
    print("=== Event Support Requirement Test ===")
    
    # Test case 1: HIGH salience with events but no SUPPORTED events → CONTRADICT
    event_atom_count_1 = 2\n    salience_1 = \"HIGH\"\n    supported_1 = [\"John was born in London\"]  # No EVENT atoms\n    \n    # Simulate the check\n    supported_event_atoms_1 = []\n    should_contradict_1 = event_atom_count_1 > 0 and salience_1 == \"HIGH\" and not supported_event_atoms_1\n    \n    print(f\"Case 1: {event_atom_count_1} events, {salience_1} salience, no supported events\")\n    print(f\"Should contradict: {should_contradict_1} (expected: True)\")\n    assert should_contradict_1 == True\n    \n    # Test case 2: HIGH salience with events and SUPPORTED events → Allow to continue\n    event_atom_count_2 = 2\n    salience_2 = \"HIGH\"\n    supported_2 = [\"John met Napoleon\", \"He was born in London\"]  # Has EVENT atom\n    \n    # Simulate EVENT atom detection (simplified)\n    supported_event_atoms_2 = [\"John met Napoleon\"]  # Assume this is EVENT type\n    should_contradict_2 = event_atom_count_2 > 0 and salience_2 == \"HIGH\" and not supported_event_atoms_2\n    \n    print(f\"Case 2: {event_atom_count_2} events, {salience_2} salience, has supported events\")\n    print(f\"Should contradict: {should_contradict_2} (expected: False)\")\n    assert should_contradict_2 == False\n    \n    # Test case 3: LOW salience with events but no SUPPORTED events → Allow to continue\n    event_atom_count_3 = 2\n    salience_3 = \"LOW\"\n    supported_3 = []\n    \n    supported_event_atoms_3 = []\n    should_contradict_3 = event_atom_count_3 > 0 and salience_3 == \"HIGH\" and not supported_event_atoms_3\n    \n    print(f\"Case 3: {event_atom_count_3} events, {salience_3} salience, no supported events\")\n    print(f\"Should contradict: {should_contradict_3} (expected: False)\")\n    assert should_contradict_3 == False\n    \n    # Test case 4: No events → Allow to continue\n    event_atom_count_4 = 0\n    salience_4 = \"HIGH\"\n    supported_4 = []\n    \n    supported_event_atoms_4 = []\n    should_contradict_4 = event_atom_count_4 > 0 and salience_4 == \"HIGH\" and not supported_event_atoms_4\n    \n    print(f\"Case 4: {event_atom_count_4} events, {salience_4} salience, no supported events\")\n    print(f\"Should contradict: {should_contradict_4} (expected: False)\")\n    assert should_contradict_4 == False\n    \n    print(\"[OK] Event Support Requirement logic works correctly\")\n\n\ndef test_rule_priority():\n    \"\"\"Test that Event Support Requirement comes after HARD_VIOLATION\"\"\"\n    print(\"\\n=== Rule Priority Test ===\")\n    \n    # HARD_VIOLATION should override Event Support Requirement\n    has_hard_violations = True\n    event_atom_count = 2\n    salience = \"HIGH\"\n    supported_event_atoms = []\n    \n    if has_hard_violations:\n        decision = \"HARD_VIOLATION\"\n    elif event_atom_count > 0 and salience == \"HIGH\" and not supported_event_atoms:\n        decision = \"EVENT_SUPPORT_REQUIRED\"\n    else:\n        decision = \"CONTINUE\"\n    \n    print(f\"With HARD_VIOLATION: {decision} (expected: HARD_VIOLATION)\")\n    assert decision == \"HARD_VIOLATION\"\n    \n    # Without HARD_VIOLATION, Event Support Requirement should trigger\n    has_hard_violations = False\n    \n    if has_hard_violations:\n        decision = \"HARD_VIOLATION\"\n    elif event_atom_count > 0 and salience == \"HIGH\" and not supported_event_atoms:\n        decision = \"EVENT_SUPPORT_REQUIRED\"\n    else:\n        decision = \"CONTINUE\"\n    \n    print(f\"Without HARD_VIOLATION: {decision} (expected: EVENT_SUPPORT_REQUIRED)\")\n    assert decision == \"EVENT_SUPPORT_REQUIRED\"\n    \n    print(\"[OK] Rule priority works correctly\")\n\n\nif __name__ == \"__main__\":\n    print(\"Testing Event Support Requirement Rule\\n\")\n    \n    test_event_support_requirement()\n    test_rule_priority()\n    \n    print(\"\\n[SUCCESS] Event Support Requirement implemented correctly!\")\n    print(\"\\nRule: If claim has ≥1 EVENT atom and salience == HIGH,\")\n    print(\"then at least one EVENT atom must be SUPPORTED or → CONTRADICT\")